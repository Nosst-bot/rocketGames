<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8">
  <title>Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Tus estilos personalizados -->
  <link rel="stylesheet" href="styles.css">
</head>

<body style="background-color:#f1f3f4;"><!-- gris claro agradable -->
  <nav class="navbar navbar-expand-lg fs-5 bg-white sticky-top shadow-sm">
    <div class="container px-4">
      <a class="navbar-brand d-flex align-items-center text-white fw-bold" href="index.html">
        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="currentColor" id="brandLogo"
          class="bi bi-rocket-takeoff-fill" viewBox="0 0 16 16">
          <path
            d="M12.17 9.53c2.307-2.592 3.278-4.684 3.641-6.218.21-.887.214-1.58.16-2.065a3.6 3.6 0 0 0-.108-.563 2 2 0 0 0-.078-.23V.453c-.073-.164-.168-.234-.352-.295a2 2 0 0 0-.16-.045 4 4 0 0 0-.57-.093c-.49-.044-1.19-.03-2.08.188-1.536.374-3.618 1.343-6.161 3.604l-2.4.238h-.006a2.55 2.55 0 0 0-1.524.734L.15 7.17a.512.512 0 0 0 .433.868l1.896-.271c.28-.04.592.013.955.132.232.076.437.16.655.248l.203.083c.196.816.66 1.58 1.275 2.195.613.614 1.376 1.08 2.191 1.277l.082.202c.089.218.173.424.249.657.118.363.172.676.132.956l-.271 1.9a.512.512 0 0 0 .867.433l2.382-2.386c.41-.41.668-.949.732-1.526zm.11-3.699c-.797.8-1.93.961-2.528.362-.598-.6-.436-1.733.361-2.532.798-.799 1.93-.96 2.528-.361s.437 1.732-.36 2.531Z" />
          <path
            d="M5.205 10.787a7.6 7.6 0 0 0 1.804 1.352c-1.118 1.007-4.929 2.028-5.054 1.903-.126-.127.737-4.189 1.839-5.18.346.69.837 1.35 1.411 1.925" />
        </svg>
        <span class="ms-3 text-capitalize fs-4 text-black">
          Rocket<span class="text-warning m-0">Games
          </span>
        </span>
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mx-auto mb-2 mb-lg-0 gap-3">
          <li class="nav-item">
            <a class="nav-link nav-modern" aria-current="page" href="index.html">Inicio</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle nav-modern" href="#" role="button" data-bs-toggle="dropdown"
              aria-expanded="false">
              Categorías
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#"><img src="assets/steam.svg" alt="PC" width="20" class="me-2">PC</a>
              </li>
              <li>
                <hr class="dropdown-divider">
              </li>
              <li><a class="dropdown-item" href="#"><img src="assets/playstation.svg" alt="Playstation" width="20"
                    class="me-2">Playstation</a></li>
              <li>
                <hr class="dropdown-divider">
              </li>
              <li><a class="dropdown-item" href="#"><img src="assets/xbox.svg" alt="Xbox" width="20"
                    class="me-2">Xbox</a></li>
              <li>
                <hr class="dropdown-divider">
              </li>
              <li>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <img src="assets/nintendo-switch.svg" alt="Nintendo" width="20" class="me-2">
                  Nintendo
                </a>
              </li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-modern" href="contacto.html">Contacto</a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-modern" href="sobrenosotros.html">Sobre nosotros</a>
          </li>
        </ul>

        <!-- Iconos derecha -->
        <ul class="navbar-nav d-flex flex-row gap-3">
          <li class="nav-item">
            <a class="nav-link text-white position-relative p-3 rounded-circle" href="cart.html">
              <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="currentColor" class="bi bi-cart-fill"
                viewBox="0 1 16 16">
                <path
                  d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2" />
              </svg>
              <span class="text-black fw-bold position-absolute fs-6 bottom-50 rounded-circle badge bg-body-tertiary"
                id="cartCounter"></span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-white p-3 rounded-circle" href="login.html">
              <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="currentColor"
                class="bi bi-person-fill" viewBox="0 1 16 16">
                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6" />
              </svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-12 col-md-6">
        <!-- Card con bordes redondeados y sombra -->
        <div class="card shadow-lg rounded-4">
          <div class="card-body p-4">
            <h1 class="h4 mb-3 text-center">Iniciar sesión en Rocket Games</h1>

            <form id="loginForm">
              <div class="mb-3">
                <label for="email" class="form-label">Correo</label>
                <input type="email" class="form-control" id="email" required placeholder="tucorreo@gmail.com">
              </div>
              <div class="mb-3">
                <label for="password" class="form-label">Contraseña</label>
                <input type="password" class="form-control" id="password" required minlength="6">
              </div>

              <div id="loginMsg" class="alert d-none"></div>

              <!-- Botón rojo Rocket -->
              <button type="submit" class="btn btn-danger w-100">Ingresar</button>
            </form>

            <hr>
            <p class="text-center">
              ¿No tienes cuenta? <a href="register.html" class="nav-modern">Registrarse</a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <!-- Tu store de auth -->
  <script src="js/auth.js"></script>

  <script>
    $(function () {
      $('#loginForm').on('submit', function (e) {
        if (!this.checkValidity()) {
          this.reportValidity(); // muestra tooltips nativos
          e.preventDefault();
          return;
        }

        e.preventDefault();
        const resp = AuthStore.loginUser($('#email').val(), $('#password').val());
        const $msg = $('#loginMsg').removeClass('d-none alert-danger alert-info alert-success').empty();

        if (!resp.ok) {
          if (resp.code === 'not_found') {
            $msg.addClass('alert alert-info')
              .html(`Correo no registrado. <a href="register.html?email=${encodeURIComponent($('#email').val())}" class="nav-modern">Regístrate aquí</a>.`);
          } else {
            $msg.addClass('alert alert-danger').text(resp.message || 'Error al iniciar sesión.');
          }
          return;
        }
        // Éxito → redirige
        window.location.href = resp.dest || 'index.html';
      });
    });
  </script>
   <script src="js/cart.js" type="module"></script>
</body>

</html>